var sharedLayout=sharedLayout||{};sharedLayout.updateProfileModule=function(){function u(n){var t=n.find(".modal-dialog"),r=t.outerWidth(),i=t.outerHeight(),u=(r<window.innerWidth?r:window.innerWidth)/2,e=(i<window.innerHeight?i:window.innerHeight)/2;t.css("margin","-"+e+"px 0 0 -"+u+"px");f(n,i)}function f(n,t){var r=n.find(".modal-dialog"),i=n.find(".modal-backdrop");if(!(r.length<1)&&!(i.length<1)){var f=Math.max(t,r.outerHeight(),r[0].scrollHeight),e=s(r[0]),u=f+e;u>window.innerHeight?i.height(u>i.height()?n[0].scrollHeight:u):u<=i.height()&&i.height(window.innerHeight)}}function s(n){var t=0;do t+=n.offsetTop||0,n=n.offsetParent;while(n);return t}function h(n){var t=$(n),e=function(){u(t)},o=function(){return f(t),!1};t.on("show.bs.modal",function(){$(this).fadeIn("fast",function(){$(this).addClass("in");i.hasClass(r)||i.addClass(r);u(t,!0);$(window).bind("resize",e);$(".modal-dialog").bind("elementResize",o)})});t.on("hide.bs.modal",function(n){n.preventDefault();$(this).fadeOut("fast",function(){$(this).removeClass("in");i.attr("style","");$(window).unbind("resize",e);$(".modal-dialog").unbind("elementResize",o)})})}var n="#new-question-modal",t="confrim-profile-alert",r="modal-open",i=$("body"),e='<div class="confirm-alert confirm-alert-danger" id="'+t+'"><a href="#" class="action-link">Please confirm Your DevExpress Support Center profile settings.<\/a><\/div>',o='<div class="confirm-alert confirm-alert-success"><span>Your DevExpress Support Center profile settings have been updated.<\/span><\/div>';return{init:function(i){function c(){var r=$(n).find(".site-col-right"),i;r.find("#"+t).length||(i=$(e),r.append(i),i.find("a").click(function(){v()}))}function l(){f.modal("hide")}function v(){h(f);f.modal("show");$("#update-user-info-form").submit(function(n){if(n.preventDefault(),r.publicName.valueHasMutated(),!r.publicNameError()){var t=$(this);r.loading(!0);$.ajax({type:"POST",url:"https://services.devexpress.com/SharedLayout/api/devexpress/updateprofile/",xhrFields:{withCredentials:!0},crossDomain:!0,data:t.serialize(),success:function(n){r.loading(!1);n?a():r.publicNameError("The new public name is invalid. Public names cannot contain obscene words and the following symbols: <>")},error:function(){r.loading(!1);a()}})}})}function y(){var t=$(n).find(".site-col-right");t.find(".confirm-alert").remove()}function a(){var i=$(n).find(".site-col-right"),r;i.find("#"+t).remove();r=$(o);i.append(r);l();u.submitChanges=s}function p(){if(u){if(u.isPropertiesLoaded())c();else var n=u.isPropertiesLoaded.subscribe(function(t){t&&(c(),n.dispose())});u.submitChanges=function(){var n=$("#"+t);n.hasClass("shake")||(n.addClass("shake"),timeout=setTimeout(function(){$("#"+t).removeClass("shake")},821))}}}var f=$("#update-user-info-modal"),u,s,r=ko.mapping.fromJSON(i);r.confirmed=ko.observable(!1);r.isPublicNameFocused=ko.observable(!1);r.publicNameError=ko.observable("");r.publicName.subscribe(function(n){n?/^customer\d+$/i.test(n)?(r.publicNameError("This Public Name cannot be used"),r.isPublicNameFocused(!0)):n.length>50?(r.publicNameError("Public Name cannot exceed 50 characters"),r.isPublicNameFocused(!0)):r.publicNameError(""):(r.publicNameError("Public Name is required"),r.isPublicNameFocused(!0))});r.loading=ko.observable(!1);r.close=function(){l()};ko.applyBindings(r,f[0]);$(n).on("show.bs.modal",function(){!r.confirmed()&&supportCenter.client&&supportCenter.newTicketViewModel&&(u=supportCenter.newTicketViewModel,s||(s=u.submitChanges),p())});$(n).on("hide.bs.modal",function(){r.confirmed()&&u&&(u.submitChanges=s);y()})}}}()